Recording Artist Manual
by Rick Gerkin
copyright 2010-2014

This manual explains installation and use of the Recording Artist package for Igor, developed and licensed by Richard C. Gerkin, PhD.  Recording Artist is used for electrophysiology experiments and analysis, including in vitro and in vivo patch clamp, extracellular stimulation/recording, and just about anything else you have the equipment to record. 

(1) Installation:

(1.1) Be sure you have a valid, purchased Igor license.  You can purchase a license from https://www.wavemetrics.com/order/order.htm

(1.2) Be sure you have the latest version installed.  If you have already installed a version of Igor >= 6.1, you can simply update to the latest version: 
http://www.wavemetrics.net/updaters61.html

If you have no Igor >= 6.1 installation, you will need to install Igor 6.34 by downloading the following: 
http://www.wavemetrics.net/Downloads/Win/setupIgor6.exe

A fresh installation will work fully featured for 30 days until you must enter your license key. 

(1.3) Install TortoiseHg, a revision control program that enables you to keep your Igor code (and any other projects) updated with the version on the server.  This will allow you to immediately browse and download updated code from the server that I maintain.  You can download TorotiseHg here: 
http://tortoisehg.bitbucket.org
Restart the computer if needed. 

(1.4) Run Igor 6.34 one time, and then quit.  This will create some Igor folders in your My Documents folder that we will use to install the code. 

(1.5) Install the latest version of my code in those new folders.  You can do this by browsing to your My Documents folder, and then to Wavemetrics/Igor Pro User Files.  This is the Igor folder where each Windows user can store her own procedure files.  They will be unique to each Windows user.  The previous location of this folder, in the C:/Program Files/Wavemetrics/Igor Pro Folder, is no longer advised due to issues with Windows Vista/7 compatibility, and because each user would be forced to share files. 

Once at the My Documents location for Igor Pro User Files, right click the User Procedures folder and select TortoiseHg / Clone... and enter https://bitbucket.org/rgerkin/recording-artist in the URL section.  Verify that a folder ending in User Procedures/recording-artist is being created on your hard drive.  A folder name ending in Recording Artist is also acceptable.  Click "OK" and the latest version of my code will be installed in your User Procedures folder.  This simply makes my code accessible to Igor.  

(1.6) In order to run the essential elements of my code when Igor starts, you will need to make a shortcut to the newly created subfolder of User Procedures/recording-artist called Core and put that shortcut in the Igor Procedures folder, which is at the same level as the User Procedures folder.  This will cause the Core procedure files of my package to be launched when Igor runs.  These Core procedure files can then recruit the other procedure files as needed. 

(1.7) In the Igor Extensions folder, which is at the same level as the User Procedures folder, you willl need to put any Igor extensions that you need to run your hardware or any other custom operations.  Examples of this include the XOPs for A/D devices.  

I currently support all HEKA/Instrutech branded A/D devices.  For all devices other than the ITC-18, you will need to download the LIH XOP (http://www.heka.com/download/windows/lih_xop.zip).  In this .zip file you will also find the files EpcDLL.dll, LIH88Driver.dll, and LIH88Service.exe.  These three files must be placed in the Igor Pro Folder containing the Igor executable.  

For the ITC-18, you can alternatively download the ITC-18 XOP at http://www.heka.com/instrutech/IgorXOPs/Win/ITC18_X86.zip; this latter option is older, and less likely to receive future support from HEKA, but has logged more use by Igor users. The ITC driver is also required and is available at http://www.heka.com/download/windows/Heka_Driver.zip

For National Instruments devices, you will need to be use the NIDAQmx drivers (which are probably already installed if you began using the device on your computer later than 2005) at http://joule.ni.com/nidu/cds/view/p/id/1614/lang/en, and you will need to install the NIDAQmx XOP from Wavemetrics, available at ftp://ftp.wavemetrics.net/NIDAQ_Tools/NIDAQToolsMXDemo/NIDAQToolsMXDemo.zip.  This is a demo of the NIDAQmx XOP, and purchase of a license can be arranged with Wavemetrics as above.  

Note that you can use both HEKA/Instrutech and National Instruments devices simultaneously (requiring both XOPs) with Recording Artist. 

(2) Initial Setup of Profiles and Acquisition Modes:

Section 2 and 3 contain a series of steps you will also have to do once, along with an additional description of what is going on.  For each successive installation, you can simply copy a series of directories (explained below) to bypass these steps, assuming you want the same settings in every installation. 

(2.1) Launch Igor.  If all instructions have been followed and the required drivers for your devices are found, all of my code will compile at startup and there will be no compilation errors.  However, you may get a message that says "No profiles were found".  This refers to the absence of any Igor profiles.  My package allows you to create distinct Igor profiles, for which different sets of preferences can be saved.  These preferences can include most experiment settings including stimulus configuration and analysis, graph settings, and which Igor code to use.  These profiles can be different people, e.g. Bob and Mary, or simply different kinds of experiments performed by the same person, e.g. BobPatch and BobField.  You will want to create a profile to get started.  

To create a new profile, you will want to go to the Profiles menu in the Igor menu bar, select Edit Profiles, enter a name in the white box in the upper right.  The name should contain only letters, numbers, and underscores.  You should avoid using the name Rick (my name), as that will unlock several features that will probably be confusing.  Optionally check the boxes for Basics, Acquisition, etc. underneath the name you provided and click Add.  You can add as many profiles as you want, although you will only need one for now.  Each time you start Igor, the last selected profile will loaded for the new session.  You can switch between profiles from the Profiles menu in the Igor menu bar.  The current profile will be identified with brackets around her name.  To select the profile you just created, select it from the Profiles menu.  

(2.2) You have two options now: setup your Igor configuration from scratch, or copy it from someone else (a labmate perhaps?).  If you want to set it up from scratch, follow steps 2.3b-2.5.  Even if you don't, it would be worth reading these steps so you understand how to change, e.g., gains in Igor to match your amplifier settings if they are different from the settings of the person whose Igor settings you copied.  If you want to copy settings from someone else, proceed instead to step 2.3a. 

(2.3a) Quit Igor.  Now, in order to copy settings from another user, you must get the following folders from them (in place of rick put their Windows user name):  

If they are using Windows Vista/7:
c:\users\rick\my documents\wavemetrics and
c:\Users\rick\AppData\Roaming\waveMetrics\Igor Pro 6\Packages\Profiles

If they are using Windows XP:
c:\documents and settings\users\rick\my documents\wavemetrics and
c:\documents and settings\users\rick\application data\wavemetrics\Igor Pro 6\Packages\Profiles

If they are using a Mac: 
/Users/rick/Documents/WaveMetrics
/Users/rick/Library/Preferences/WaveMetrics/Igor Pro 6 Intel/Packages/Profiles

Once you have those folders, copy their entire contents into the corresponding folders on your computer, e.g. if your Windows username is Bob, place them in the same folder as above but with Bob substituted for the name of the user you got the folders from.  Build the full destination path name according to your operating system, not theirs.  Once these files are copied, start Igor again.  Go to the Acquisition menu and select Initialize Experiment from Scratch.  There is also an option for initializing from saved settings, but you do not yet have any settings saved.  A number of waves, variables, and folders will be automatically created, as well as two windows that fill the screen.  You will be prompted for the name of an experiment.  The name is not important now, but note that if you paste from the clipboard into the experiment name dialog, it will paste an experiment name that is derived from the current date.  Proceed to step 2.6.  

(2.3b) You are ready to set up some of the preferences for an experiment.  Go to the Acquisition menu and select Initialize Experiment from Scratch.  There is also an option for initializing from saved settings, but you do not yet have any settings saved.  A number of waves, variables, and folders will be automatically created, as well as two windows that fill the screen.  You will be prompted for the name of an experiment.  The name is not important now, but note that if you paste from the clipboard into the experiment name dialog, it will paste an experiment name that is derived from the current date. 

(2.4) Letâ€™s create fundamental measurement quantities.  Go to the Profiles menu and select Edit Modules and then Acq.  Go to the Quantities tab and create your favorite units.  For example, go to the column on the right, and create a quantity named Amps with Units:A, Prefix:p, and Type:Current.  Click Add.  Do this for Current, Voltage (named e.g. Volts), and Resistance (named e.g. Ohms), at least.  If you want a greek Ohm symbol, using \F'Symbol'W in the Units field when you make your resistance.  Click Save.  All of this allows a) people to have different preferences about unit symbols and prefixes and b) my code to have access to knowledge about what kinds of things are represented by units so that it can figure out e.g. that mV/pA = GOhms.  

(2.5) Now go to the Acq Modes tab.  This is a master control panel from which most experiment settings and preferences can be configured.  There are several ways to get to this panel, of which the above is just the first.  Select the tab that says AcqModes.  This allows you to edit Acquisition Modes.  Acquisition Modes are modes of operation that describe the nature of the data being collected through the A/D device.  An common example of an Acquisition Mode would be Voltage Clamp.  Another example would be Digital Stim.  By default, there is only one acquisition mode called Unity.  This is a dumb mode that assumes that the raw, unscaled A/D input/output is meaningful.  It is rarely used except to test your A/D device, or if the raw amplifier voltage is meaningful in your experiments.  Typically, you will prefer input/output that is scaled according to the output/command gain of your amplifier, so that the units as displayed/set in Igor correspond to the units recorded/delivered to your experimental preparation (prep). 

Let's create a new acquisition mode.  Most people use voltage clamp in some of their experiments, so let's create such a mode.  To the right of Unity there is an empty box for a new mode.  Enter VC to represent voltage clamp.  You can call it whatever you like (alphanumeric characters and underscores only), but VC will do the trick.  Now, let's set the gains.  This can be one of the most confusing parts of the entire experimental setup.  First, we need to remember that when Igor communicates with the A/D device, Igor's output is the input of the object on the other end of the A/D device, e.g. an amplifier.  And Igor's input is the output of that object.  This means that the inputGain in Igor is the object's output gain.  This is summarized below: 

Igor <-> A/D Device (ITC18, NIDAQ) <-> Amplifier <-> Prep (Cells)

Note: it is possibly to have gains chosen automatically according to your Multiclamp settings if you uses Multiclamp Commander along with a Multiclamp Amplifier.  Contact me if this applies to you and you are interested in this feature. 

Suppose the object (e.g. an amplifier) has an output gain of 10 mV/pA.  This means that whenever the amplifer records 5 pA from the prep, it will send 5*10 = 50 mV to the A/D Device.  Now, the A/D Device has its own scaling (digitization), but my package already knows about that.  All you need to tell it is about the 10 mV/pA applied by the amplifier so Igor can apply the reverse arithmetic and recover the original signal, 5 pA.  To do this, set the "inputGain" beneath the "VC" you just entered to 10.  If you amplifier has an output gain of 2 mV/pA in voltage clamp, you would set this to 2.  Some amplifiers report their settings in other units, such as V or nA.  You will need to convert to mV/pA to get the correct value.  For example, if the output gain of the amplifier is 0.002 V/pA, this is equivalent to 2 mV/pA, so the inputGain would still be 2.  Some experimenters prefer to report their units for voltage clamp recordings in nA instead of pA.  In this case, multiply the value you would have entered by 1000. 

Now let's set the outputGain.  This is the gain applied to the signal sent by Igor (i.e. a stimulus) by the amplifier before being sent to the prep.  In the amplifier, this is sometimes called the "command" gain.  In voltage clamp, the command applied is a voltage, and thus the gain will be reported in mV/V, mV/mV, or V/V.  Note that in all cases either the numerator or denominator of a gain will have units of voltage, because that is the only kind of signal that an A/D device understands.  Most deal with signals ranging from -10 to 10 V, and you typically set your amplifier gain to use as much of that range as possible, i.e. if you expect to deal with small signals your gain will be set to a large number to cover nearly all of the range -10 to 10 V.  Now, suppose the command gain on your amplifier is 10 mV/V.  This means that for every volt that you send to the amplifier, it will send 10 mV to the prep.  Another way we could express this is 0.01 mV/mV.  My Igor package likes to deal with A/D voltages in mV, so the number you would enter for outputGain would thus be 0.01 mV.  As with the inputGain case, if you prefer to design your stimuli for voltage clamp in some unit other than mV, like V (a strange choice!), you would want to divide that number by 1000.  Ultimately, when you design a stimulus in Igor, my package will take that stimulus, divide by the outputGain and send that voltage to the A/D device.  The A/D device will relay that to the amplifier which will apply its command gain to generate a signal to send to the prep.  So if you create a stimulus consisting of a 10 mV step, Igor would send a 10/0.01 = 1000 mV = 1 V signal to the A/D device.  The A/D device would send 1 V to the amplifier which would then send 1 V * 10 mV/V = 10 mV to the prep, as specified. 

The testPulsestart, testPulselength, and testPulseampl settings specify the nature of a "test pulse", used to monitor the passive electrical properties of the prep, that you might want to use in this mode.  Typically, test pulses in e.g. voltage clamp and current clamp might have different characteristics (amplitude, duration) reflecting the different membrane time constants in these two modes.  Some modes, like a digital signal sent to a stimulus isolator, have no test pulse at all.  The start time, duration, and amplitude of the test pulse can be specified by these three settings, and the units of each are s, s, and whatever the command units are for the mode (e.g. mV in voltage clamp). 

Finally, you set the inputUnits and outputUnits of the mode.  You have already implicitly chosen these in your choice of the inputGain and outputGain.  If you specified your gains such that measurements of your prep would be reported in pA and the stimulation would be delivered in mV, then these are your inputUnits and outputUnits, respectively.  Simply enter "pA" in "mV" (without the quotes) in those two fields.  Note that axes in Igor will be labeled using these units, so if you prefer to see "millivolts" instead of "mV" in your axes, then enter that instead. 

Now click the "Add" button and "VC" will be added to the list of acquisition modes that you can specify for any of your recording channels.  Typically, when values are added, deleted, or changes in this User Settings panel, the changes persist only through the current experiment.  In order to make changes persist through future experiments, you will need to press the "Save" button in the upper left hand corner.  Note that this only saves these settings, not the experiment itself.  Since you probably want to use this new "VC" mode in future experiments, you should press the "Save" button now. 

Examples of some other modes that you might like to add are "CC" for current clamp, and "Digital" for the control of digital channels on your A/D device (such as TTL outputs).  For the "CC" mode, the inputGain is likely to be in units of "mV/mV", the outputGain is likely to be in units of "pA/mV".  If you get confused, you can hover your cursor over the empty field and look at the help message at the bottom of your Igor window.  The "Digital" mode is sort of a special case because there are really no gains to apply and no units.  The amplitude of a stimulus is determined by whatever is on the other end of the digital output attached to your A/D device (e.g. a knob on a stimulus isolator), so you should set the gains here to 1.  The reasons for setting them to 1 will become apparent in the section on stimuli using digital outputs.  If you like, you can select some of the other tabs in the User Settings panel, but you don't need to configure anything else from this panel at the moment.  If the last section seemed to take a long time, don't worry.  You only need to set this up once in your life (hopefully).  You will be able to copy these settings to any other users (or any other computers) that you want, as explained in the section on transferring settings to other users and computers.  Their settings may need to be modified if they use different gains in their experiments.  You can now close the User Settings window. 

(3) The selector panel: channels, stimuli, and acquistion:

There should be two large windows filling up the screen: an upper window and a lower window.  The upper window is where you view, and control the display of, acquired data such as "sweeps" recorded from your prep.  The lower window is where you view, and control the display of, analysis of these sweeps.  In the upper window, press the "Selector" button.  This will open the "Selector" panel, which is the control panel for designing/delivering your stimuli and acquiring data.  This is very powerful panel that will allow you to design experiments of arbitrary complexity. 

(3.1) First, note the "# Channels" control in the upper left.  You can change the number of acquisition channels by toggling this up and down. 

You will see that there is one line of controls for each channel.  Each line starts with an "On" checkbox.  This turns the channel on and off.  If you want to temporarily disable a channel, unchecking this box is the way to go.  Next is a color control, which will change the color that is used to display data and analysis for this channel in all graphs. 

(3.2) Next is the channel label.  The default names are "ch0", "ch1", etc., but you can change these to whatever you want (alphanumeric plus underscore, no spaces).  Examples of channel labels might be "cell0", "cell1", "stimulator0", "stimulator1", "heartrate", "temperature", etc.  Note that there is a pull-down menu to the right of the channel label.   Here you can select pre-configured channels.  This list will populate with any channel configurations (designated by the channel labels) that you choose to save be selecting "Save".  This will be discussed in the section on the Preference Saving Hierarchy. 

(3.3) Next is the "ADC" control.  "ADC" stands for "Analog to Digital Conversion".  This refers to the channel number on your A/D device that will send data to this Igor channel.  If you get confused, remember that your prep is (probably) an analog system, and Igor is digital, so ADC corresponds to the A/D device channel that sends data from your prep to Igor.  This pull-down menu has a number of options, corresponding to the available channels on your A/D device.  If the only option in the menu is "N", this means that either your device drivers or your XOP is not correctly installed, and you will need to fix this.  If everything is installed correctly, the menu will have something like 0, 1, 2, ..., D, N.  The numbers correspond to analog input channels on your A/D device.  Typically, there are many of these.  The "D" corresponds to digital input, meaning that you intend to record a digital (off or on) signal on this channel.  The "N" corresponds to "null" input, meaning that you don't intend to record anything on this channel.  You might use "N" on a channel connected to a stimulus isolator, for example, since the stimulus isolator is not used to record anything.  If you plan to record analog input from an amplifer, follow your BNC cable from the amplifier to the A/D device.  If it goes into channel 0 on the A/D device, then you want to set the "ADC" menu to 0 to record data from this amplifier channel. 

(3.4) Next is the "DAC" control.  This stands for "Digital to Analog Conversion", and refers to the channel number on your A/D device to which Igor sends commands/stimuli.  You will have a similar list of options on this menu, although usually fewer than in the ADC menu because most A/D devices have fewer outputs than inputs.  Again, "D" is for digital output, e.g. controlling the timing of a stimulus isolator, a valve opening, etc., and "N" is for no output, e.g. recording a field signal, a heart rate, etc.  Assign this channel according to the same reasoning as with the ADC channel.  Note that the ADC channel and the DAC channel do not need to be the same, and they do not need to correspond in any way to the Igor channel.  The Igor channel number is simply the row index of the channel in the selector window.  So the first row is called Igor channel 0, but it might have ADC set to 3, and DAC set to N. 

(3.5) The next menu is "Mode".  This allows you to choose the acquisition modes that you set in section 2.  The default mode is "Unity", but if you set up "VC" for voltage clamp, you can pick that from the menu to let Igor know to set the channel up for voltage clamp.  If you want to edit an existing mode, you can select "Edit", which will bring you to the same User Settings panel from which you created the modes.  You can change values as you see fit, but don't forget to click "Save" if you want to save changes for the next experiment. 

(3.6) Next is the Stimulus name.  To edit the name of the current stimulus, simply type a new name.  To select from existing stimuli, pick one from the pull-down menu to the right.  You will be able to add stimuli to this menu, as covered in the section on the Stimulus Preview Window. 

(3.7) Next is the "Seal Test" button.  Most experiments utilizing glass electrodes involve a Seal Test to monitor the resistance of the electrode as it descends through the prep.  This is a good way to test whether your gains are set up correctly.  If you attach a model cell to your amplifier headstage, you will be able to confirm the known resistances in the Seal Test window.  For example, the model cell provided by Molecular Devices (formerly Axon Instruments) has a "Bath" setting (10 Megaohm resistance) and a "Cell" setting (500 Megaohm resistance).  If your amplifier is in voltage clamp mode, and you have selected "VC" in the mode menu, and press "Seal Test", you should see a seal test pulse and a resistance reported in the upper left corner corresponding to the model cell resistance.  The same should be true if your amplifier is in current clamp mode and you have selected "CC" in the mode menu.  If the resistances are incorrect, it is likely that you have specified your gains incorrectly in the User Settings panel and you should change these until the resistance is correct.  The Seal Test window will be covered further in the section on the Seal Test Window.  Note that closing the Seal Test window ends the seal test. 

(3.8) Next is the "Add" button which, if checked, adds the stimulus selected from the pull-down menu to the stimulus components on the right side of the panel.  If it is not checked, the stimulus will be determined entirely by those stimulus components.  If this is confusing, leave it unchecked.  In some cases, the box is uncheckable. 

(3.9) Next is the "TP" checkbox, which stands for "Test Pulse".  If this is checked, the test pulse specified in the User Settings panel for the currently selected acquisition mode, e.g. VC, will be delivered with each stimulus.  This allows you to turn the test pulse on and off independently from the rest of the stimulus. 

(3.10) Next are a series of numeric controls: "Width", "Ampl", "dAmpl", "Pulses", "IPI", "Begin", and "Divisor".  These control the composition of the stimulus pulses in each sweep.  "Width" controls the width of a stimulus pulse (in ms); "Ampl" controls its amplitude (in the units specified when the acquisition mode was setup, e.g. mV for voltage clamp; dAmpl controls an increment in the amplitude with each pulse, if you desire a series of pulses with increasing or decreasing amplitude; "Pulses" controls the number of stimulus pulses; "IPI" controls the interval between pulses (from the start of one pulse to the start of the next); and "Begin" controls the start time of the first pulse (not counting the test pulse).  Play around with these controls to build a stimulus. 

(3.11) To preview the stimulus that you have built, click the "Preview" button.  It should be apparent whether the stimulus you desire was built correctly from these numeric controls.  The Preview Window will be covered more extensively in the section on the Stimulus Preview Window.  If the duration of the stimulus (evident from the time-based on the x-axis) is not long enough to show any/all of the stimulus pulses, you may need to increase the stimulus duration (see below).  

(3.12) Next is the "Divisor" control.  This allows you to specify on which "sweeps" you would like this stimulus to be delivered.  By default, a stimulus is delivered on all sweeps.  The simplest example of this technique is to deliver a stimulus on only the even-numbered sweeps.  To achieve this, increase "Divisor" to 2 on one channel.  Notice that two boxes appear to the right of the "Divisor" control.  These are called the "Remainder" boxes.  The terms "Divisor" and "Remainder" come from modular arithmetic, which is really just a fancy way of saying long division.  For example, suppose that the sweep number is 37 (the first sweep in every experiment is sweep 0).  If the divisor is 2, then 37 divided by 2 is 18 with a remainder of 1.  We only care about the remainder, which is 1.  Note that when you divide a number by 2, the remainder can only be 0 or 1.  This is why there are two checkboxes.  If the first checkbox is checked, the stimulus will be delivered on sweeps where dividing by 2 gives a remainder of 0.  If the second checkbox is checked, the stimulus will be delivered on sweeps where dividing by 2 gives a remainder of 1.  This can be extended to other divisors.  Suppose you wanted to stimulate only every 3rd sweep.  By setting the divisor to 3, there are now three possibilities for the remainder and so there are 3 boxes.  Checking the first box alone will cause the stimulus to be delivered only on sweep numbers divisible by 3 (remainder of 0).  Checking only the second box will cause the stimulus to be delivered on only sweep numbers which, when divided by 3, give a remainder of 1.  This can be made arbitrarily complex.  For example, you could cause a stimulus to be delivered only on the 2nd and 4th of every 7 sweeps by setting the divisor to 7 and checking the 2nd and 4th boxes. 

The Divisor/Remainder technique will allow you to deliver a stimulus to a channel on only certain sweeps.  But what if you want to deliver another stimulus to that channel on other sweeps?  How can two stimuli be assigned to the same channel, e.g. to alternate with each sweep?  This is where the concept of multiple "Pulse Sets" comes in.  The stimulus you just constructed using the "Width", "Ampl", etc. controls is composed of only one pulse set.  To assign another pulse set, utilizing one or more different parameter value, to the channel stimulus, you need to add a pulse set.  To do this, look at the top of the Selector Window.  There are three tabs, one with a "-", one with a "0", and one with a "+".  Click the "+" tab.  This will add one pulse set.  (You can delete the last pulse set by clicking the "-" tab).  Now there will also be a tab that says "1".  This means there are now two pulses sets, pulse set 0 and pulse set 1.  By default, pulse set 1 will have the same parameters as pulse set 0.  To see that this is the case, click the "1" tab.  You will see that the pulse parameters should be unchanged.  However, if you change the value of one of these parameters (e.g. Ampl), you can click back and forth on the "0" and "1" tab and see that each of these now has its own value for "Ampl".  Now, change the value of another parameter, e.g. "Begin", while the "1" tab is selected.  Now, if you preview the stimulus by clicking "Preview", you will see that the stimulus on this channel is the superposition of the stimulus constructed from pulse set 0 and the stimulus constructed from pulse set 1.  

(3.13) This technique can be used to construct a stimulus of arbitrary complexity, since any set of pulses, no matter their number, size, and spacing, can be constructed from some number of simpler stimuli -- those simpler stimuli are what we build using one pulse set.   Now, what if, instead of superimposing them, we wish to separate these two pulse set stimuli so that one is presented during odd-numbered sweeps and one during even-numbered sweeps?  To do this, we combined the Divisor/Remainder technique with the Multiple Pulse Sets technique.  Starting from scratch, we would create the "even" stimulus first.  Then we would increase "Divisor" to two and click the first of the two "Remainder" boxes.  Then we would increase the number of pulse sets from 1 to 2 by pressing the "+" tab.  We would click the "1" tab to edit the second pulse set.  Notice that by default it has all the same parameters as the first pulse set.  Change these parameters to build the "odd" stimulus, and then uncheck the first remainder box and check the second remainder box.  You can verify that you have done all this correctly by clicking back and forth on the "0" and "1" tabs and ensuring that the parameters change from the "even" kind to the "odd" kind and that the checked remainder box changes from the first box to the second box.  You can also confirm that this has been done correctly in the Stimulus Preview Window.  Click "Preview", and then increase the sweep number in the "Preview Sweep Number" control.  This will let you see what the stimulus will look like for each future sweep number.  If all was done correctly, your desired "odd" stimulus should be displayed when the "Preview Sweep Number" control is odd, and the desired "even" stimulus should be displayed when it is even.  

(3.14) On the bottom line of the Selector Window, the left-most control is called "Duration".  This controls the duration of the stimulus waveform, in seconds.  Note that this is actually the duration of the acquired sweep, some or all of which might contain stimulus pulses.  The maximum duration of a sweep/stimulus will depend upon your sampling rate, number of acquisition channels, and the memory in your A/D device (see "What limits the complexity of your acquisition setup?").  To the right of "Duration" is "ISI".  This stands for "Inter-Sweep Interval", and measures the interval between the start of one sweep and the start of the next, in seconds.  For example, if "Duration" is set to 8 and "ISI" is set to 10, acquisition of a sweep will last for 8 seconds, there will be a two second delay, and the next sweep will be acquired.  Whether or not the stimulus itself can persist during this delay phase depends upon your A/D device (see the section on "Differences between ITC and NIDAQ acquisition").  In some cases, you may want to acquire data continuously, such that there are no gaps in recording (no delay between sweeps).  To achieve this, simply click the next checkbox, "Continuous".  The next checkbox, "Real Time", only applies to acquisition with ITC devices.  If it is not checked, Igor will not collect the acquired sweep from the A/D device until the sweep is finished.  If it is checked, Igor will collect the sweep in pieces, such that the data appears to stream into a displayed sweep.  For NIDAQ devices, this streaming behavior occurs whether "Real Time" is checked or not.  

(3.15) The next control "Left", determines how many sweeps will be collected before acquisition stops.  If it is set to 0, sweeps will be collected indefinitely until acquisition is stopped by the user.  If it is set to any other number, that number of sweeps will be collected before acquisition stops.  To collect only one sweep, set "Left" to 1.  You will need to change it back to 0 to return to indefinite acquisition.  If you are delivering, for example, and LTD induction protocol, you might set "left" to 300, start acquisition, and then go get some coffee, confident that acquisition (and stimulation) will stop even if you do not return in time.  

(3.16) The next control "KHz" determines the sampling frequency, in KHz, or thousands of samples per second.  For example, to collect sweeps (and deliver stimuli) at a sampling frequency of 10 KHz, set "KHz" to 10.  

(3.17) The "Save" pull-down menu allows you to control how and when the experiment is saved.  By default the experiment is only saved when acquisition is stopped ("Acq Stop", indicated as the selected option by brackets), which includes pressing the "Stop" button or the experiment stopping automatically because the "Left" counter runs down to 0 (from a non-zero number).  Alternatively, you can set the experiment to save after "Every Sweep" is collected.  This is slightly safer due to the slim possibility of a program crash or power failure, however it can cause the computer to slow down as the experiment is being saved to disk every few seconds (or more often in cases where "Duration" is very short).  When experiments are saved "packed" (the Igor default, see "Experiment Formats"), the entire experiment is written to disk from scratch with every save, which can begin to take a long time if the size of the experiment begins to reach into the hundreds of megabytes.  You can also choose to save only to "Memory", which means that while all data is retained in the Igor experiment, it is never saved to disk except when you doing so manually be selecting "Save Experiment" from the "File" menu.  If you choose this mode, be sure to save manually periodically to avoid the risk of losing data.  Lastly, you can choose to save "Nothing".  This means that as soon as a sweep is collected, the previous sweep is lost forever.  This is useful for situations such as testing or monitoring for diagnostic purposes, like trying to reduce line noise by changing the grounding configuration on your rig, or trying out a new device.   It absolutely cannot be used to acquire useful data.   

(3.18) The "Preview" button opens the Stimulus Preview Window.  This allow you to preview the sweep and stimulus settings graphically, to ensure that your stimulus and acquisition will proceed as you intended.  In the graph section of the Stimulus Preview window, you can see a preview of the stimulus on each channel.  This includes the test pulse(s), if any, and the stimulus pulses, if any, that you specified in the Selector Panel.  Each channel will be displayed in its own color, according to the colors specified in the Selector Window.  The units on the y-axis will match the outputUnits specified for eachchannels acquisition mode in the AcqMode tab of the User Settings Panel.  For each channel in the Selector Panel that contains a stimulus (the channel's "On" checkbox is checked, and the DAC channel is a value other than "N"), there is a stimulus preview trace, and there is one y-axis for each Acquisition Mode among these channels.  For example, if you have two channels with mode set to "VC" and one with mode set to "CC", and all three have stimuli, there will be two stimulus traces on a "VC" axis (with likely units of "mV") and one stimulus trace on a "CC" axis (with likely units on "pA").  You can preview the stimulus for any future sweep by changing the number in the "Preview Sweep Number" control.  If you have utilized the Divisor/Remainder technique, the stimuli are likely to be different for different sweep numbers.  Otherwise, they should all be the same.  Sometimes, the stimuli on multiple channels will be identical for some period of time.  For example, the test pulse may occur at the same time on all channels.  In this case, the stimulus traces will be plotted on top of one another in the Stimulus Preview Window and it may be difficult to see them all.  If you check the "Stagger View" checkbox, the Stimulus Traces will be staggered so that stimuli occurring at the same time on multiple channels can be more easily resolved.  Note that, due to the staggering, the apparent timing and amplitude of some of the stimuli will appear to be incorrect, and only one of the traces (the one that remains unstaggered) will appear to be correct.  However, this is only an illusion caused by the staggering of the Stimulus Traces. 

(3.19) In order to start acquisition (and stimulation), press the "Start" button.  Acquisition will begin almost immediately, with a small delay to allow the A/D device to get ready to begin sending/receiving data.  After pressing "Start", the "Start" button changes to a "Stop" button, and this button is used to stop acquisition.  When "Left" is set to 0, acquisition will continue indefinitely until you press the "Stop" button.  If you press the "Stop" button prior to the completion of acquisition of a given sweep, that sweep is typically not saved.  Therefore, if you intend to use "Stop" manually, and you want to acquire 10 sweeps (and don't want to use the "Left" button) you should wait until 10 full sweeps are completed before pressing "Stop".  

(3.20) The "Reset" button resets and experiment to initial conditions.  This means that all analysis is erased, and the sweep counter is reset to 0.  Acquired sweeps are not deleted, however, as a safeguard in case you press "Reset" (and click through the warning message) accidentally.  Thus, if you collect 20 sweeps, press "Reset", and then collect 10 more, the first 10 sweeps in your experiment will correspond to the most recent 10 collected, the next 10 will correspond to the second 10 collected, and the first 10 collected will be lost forever.  Notebooks/logs remain intact, to save the user from having to re-enter experimental details that may not have changed since before the "Reset" button was pressed.  A good use of the "Reset" button is when one experiment is quickly determined to be unsuccessful (e.g. a patch clamp recording is quickly lost).  The next experiment will largely overwrite the previous, unsuccessful experiment if the "Reset" button is pressed in between experiments.  If you would like to save the data from the previous experiment, you should always create an entirely new experiment.  DO NOT simply select an "Initialize Experiment..." option from the "Acquisition" menu.  You should first save your experiment (select "Save Experiment" from the "File" menu; if it is grayed out, the experiment is already saved), then create a new experiment (select "New Experiment" from the "File" menu), and finally select an "Initialize Experiment..." option from the "Acquisition" menu.  

(3.21) Any stimulus you build can be used without being saved.  However, as soon as that stimulus is changed, or a new experiment is initialized, that stimulus pattern will be lost and you will have to build it again.  In order to save stimuli for future use, you will need to press the "Save Stimulus" button in the Stimulus Preview Window.  The channel containing the stimulus that you would like to save can be chosen from the "on" pull-down menu.  If the stimulus on channel "ch0" is the one that you want to save, select "ch0" from this menu.  The name of the stimulus is contained in the "as" menu and cannot be changed here.  It can only be changed in the Selector Panel.  Lastly, you can choose whether to save the stimulus as a series of pulses (the default) or as a raw Igor wave in the "as type" menu.  Saving the raw wave is usually only used if you want to build a noisy or smoothly varying stimulus, such as a sine wave (see "Creating Arbitrary Stimlation Patterns").  Any stimulus built using the Selector Panel can be saved properly be leaving the "as type" setting to "Pulses".  Once you have saved a stimulus by pressing "Save Stimulus", it will be available in the current experiment from the "Stimulus" pull-down menu in the selector window.  To make it available in future experiments as well, go to the User Settings Panel by going to the "User" menu and selecting "Edit Settings".  Then click the "Stimuli" tab and press the "Save" button in the upper left-hand corner.  

(3.22) The Selector Panel also allows the for post-processing of acquired sweeps.  This can be done by clicking the "Filters" tab in the Selector Panel.  The right half of the panel will be replaced by a number of filter controls for each channel.  A notch filter, typically used to eliminate line noise such as 60 Hz (in North America) or 50 Hz (in Europe), cab be activated by checking the box next to "Notch Filter", and selecting a frequency (in Hz) under "Freq".  Higher harmonics (multiples) of the same frequency can also be filtered out by setting "Harmonics" to a number higher than 1.  "Harmonics" is set to 10 by default because, empirically, this tends to result in better line noise suppression than setting it to 1.  Median smoothing can be activated by checking the box next to "Median Filter".  This will replace any values in a range of "Width" points that exceed "Thresh" of the median in that range (in the inputUnits of the channel's mode) by the median of that range.  This is similar to other kinds of smoothing, except it is better at suppressing transients without averaging in the effects of those transients the way that e.g. Gaussian smoothing would do.  The values Width=3 and Thresh=0 will replace all points in the acquired sweep with the median of the three points centered at each point.  Changing "Thresh" to 10 would replaced only single sample transients that exceeded both of their neighboring points by at least 10 units with the median of those three points.  This is an excellent way to suppress single sample transients such as high-frequency "spikes" unrelated to any physiological process, provided that those spikes are greater than 10 units in amplitude (compared to neighboring points) and that no meaningful physiological processes have the same properties.  "Low-Pass" and "High-Pass" Filters can be specified at the desired frequencies as well.  A band-pass filter can be constructed by combining these two filters (making sure that both checkboxes) are checked.  Simple "zeroing" of a trace can be achieved by checking the "zero" box.  This will simply subtract the mean from each trace.   Checking the "Power" box will open a new graph window in which the Power Spectrum of each sweep will be plotted after that sweep is acquired.  This can be useful for testing the effects of one's filters, or simply assessing the spectral content of the acquired data.   Lastly, in the "Save" pull-down menu, one can choose to filter the acquired sweeps before or after those sweeps are saved.  By default, the sweeps are filtered after they are saved, i.e. the "Raw" data is saved.  This means that the underlying data is saved unfiltered, and the sweeps are filtered "on the fly" before being displayed.  This is usually preferable since no data can be lost in this way (by a poor choice of filtering parameters).  Alternatively, one can save the "Filtered" data, discarding the unfiltered raw data. Lastly, one can choose to discard data subsequently acquired from this channel altogether, by selecting "No Save".  This might be used if one channel is collecting data which is worth monitoring, but not saving, and you would prefer for your experiments to use less memory and disk space.  

(4) The "Sweeps" Window: visualizing your acquired data:

(4.1) Acquired sweeps can be viewed in the "Sweeps" window.  By default, the most recently acquired sweep (on all channels) is shown.  The most recent sweep can be hidden by unchecking the "Last Sweep" box.  Previously acquired sweeps can be shown by checking either the "A" or "B" checkbox and changing the corresponding sweep number controls next to these checkboxes.  For example, to show sweep 2 (if it exists), check the "A" checkbox, set the value of the control immediately to its right to 2, and make sure that "Last Sweep" and "B" are unchecked.  You cannot set the value of "A" and "B" controls to a number greater than or equal to the most recently acquired sweep number.  So if you have only acquired 3 sweeps, the possible sweep numbers are 0, 1, and 2.  If you would like to view sweep 0 and sweep 2, set the control next to "A" to 0, and the control next to "B" to 2.  If you would like to view sweeps 0 through 2 (i.e. 0, 1, and 2), then do the above but also checks the "Range" box.  The "Range" box ensures that the range of sweeps from "A" to "B" are plotted.  If "Range" is checked, a control entitled "Inc" will appear, which stands for "Increment".  This determines the increment of the sweep number from the "A" value to the "B" value.  In other words, if "A" is 0 and "B" is 10, and "Inc" is set to 2,  this will result in sweeps 0, 2, 4, 6, 8, and 10 being plotted.  This is a convenient way to plot only the even-numbered sweeps.  To display only the odd-numbered sweeps, change "A" to 1.  

(4.2) To display only the sweeps for certain channels, use the checkboxes in the upper left corner of the "Sweeps" window.  Unchecking the box corresponding to the name of a certain channel will cause its sweeps to not be plotted.  Rechecking the box will bring them back.  

(4.3) "Set Baseline" allows the user to designate a segment of time in a sweep as a baseline to use for analyses.  Checking "Auto" tells Igor to automatically determine a segment of time in each sweep to use as a baseline to use for analyses.  Both of these are covered more extensively in the "Analysis" section.  

(4.3) "Restore Axes" restores the axis limits in the "Sweeps" window to their default values.  Typically, the user would change the axis limits by zooming in/out or auto-scaling using the Ctrl-A key combination.  "Restore Axes" can quickly restore the full scale of the time axis and a reasonable (for whole cell patch clamp experiments) set of axis values for the amplitude axis.  

(4.4) The "Overlay" pull-down menu allows the user to view the acquired sweeps in a variety of different ways.  "Stacked" will place all sweeps on one axis.  "By Mode" will use one axis for each acquisition mode.  For example, all sweeps collected on channels using the "VC" (voltage clamp) acquisition mode would be plotted on one axis, and all sweeps collected on channels using the "CC" (current clamp) acquisition mode would be plotted on another axis.  "Split" gives each sweep its own axis regardless of how it was acquired.  

(4.5) Checking the "Focus" box enables a very different kind of view of the acquired sweeps.  Basically, it focuses on the most important parts of each sweep.  These most important parts are determined by my own experience as physiologist and they are: the response near the time of the stimulus, the stimulus artifact on the stimulus channel, and the test pulse amplitude.  For each of these three focused views, the time axis is scaled so that t=0 occurs at the time of the stimulus or the test pulse onset.  When "Focus" is checked, the left part of the "Sweeps" window contains responses to stimuli.  Only 100 ms of the responses are shown, since this is typically enough time to show the bulk of the relevant response to a stimulus in a physiology experiment. The time marked t=0 may not be the same for two different channels, because the stimuli driving the responses on two different channels may occur at two different times.  Because there may be many combinations of stimulus and response (for example, for two channels, each with one stimulus, there are 2x2=4 combinations), as many as 4 traces may be plotted here.  In the case where there are two channels, ch0 and ch1, these 4 traces would represent ch0->ch0, ch1->ch0, ch1->ch0, and ch1->ch1, where x->y means the response on channel y triggered to the stimulus on x.  In a neurophysiology experiment in which ch0 and ch1 correspond to patched neurons, these 4 traces would correspond to two synaptic and two autaptic responses.  As another example, ch0 and ch1 could be two patched neurons (without intracellular stimulation), and ch2 and ch3 could be two extracellular stimulators.  In this case, the 4 traces would correspond to ch2->ch0, ch2->ch1, ch3->ch0, and ch3->ch1.  Igor will automatically attempt to figure out when the stimulus occurs on each channel, based on the time of the first stimulus pulse on that channel (usually the value of the "Begin" control for that channel in the Selector Window).  You can choose which of these pathways are relevant for display, by checking and unchecking the boxes in the upper left of the "Sweeps" window of the form "ch0->ch0".  These checkboxes will only be visible when the "Focus" checkbox is checked, and the names "ch0", "ch1", etc. are used instead of the actual user-defined channel labels to ensure that the checkboxes are displayed uniformly no matter what the channel labels.  The traces plotted in the upper right when "Focus" is checked are segments of each sweep triggered to the time of the stimulus on the channel itself.  So if "ch0" was stimulated (e.g. with intracellular current injection) 200 ms into the sweep, then t=0 on that axis will correspond to 200 ms.  This is a good way to examine stimulus artifacts to ensure that they are consistent across an experiment.  The traces plotted in the lower right when "Focus" is checked are segments of each sweep triggered to the time of the test pulse on the channel itself.  This is a good way to examine the test pulse response to ensure that e.g. access resistance and pipette capacitance is consistent across an experiment.  

(5) The "Analysis" Window: summary analysis of features in each sweep: 

(5.1) The Analysis Window is the window that is placed by default in the bottom half of your screen, and is titled "Analysis".  Summary plots for the experiment are shown here, typically with one point per sweep.  Many different "Analysis Methods" can be used to plot data here.  When you first create a user, the only Analysis Method shown is "Baseline".  You can see a y-axis with the label "Baseline".  This is plotted against an x-axis with a label of "Time", although that x-axis may not be initially visible.  To determine which Analysis Methods are plotted, and which channels have their summary data analyzed and plotted for each Analysis Method, click the "Analysis" button in the upper left of the Analysis Window.  This will bring up a small listbox containing a column for each channel as well as an "All" column and a "Show" column.  Suppose that you would like to calculate the baseline (mean of the first few milliseconds) value for sweeps acquired on channel "ch0" (or whatever you have called your first channel) but not channel "ch1".  You would check the "ch0" box in the row containing "Baseline", and uncheck the "ch1" box.  If you check/uncheck "All", it will automatically check/uncheck all the channel boxes.  The "Show" checkbox determines whether the calculated data (and the corresponding y-axis) will actually be shown in the Analysis Window.  There are reasons that you might want to compute analysis online but not always show it; for example, you might like to compute the input resistance of a channel but not have it take up valuable screen space all the time.  In this case, you would add the Analysis Method "Input_Resistance" (covered in a later section) but leave the "Show" box unchecked. 

(5.2) After you have checked/unchecked the appropriate boxes, click "Analysis" again and the listbox will disappear.  Analysis of previously acquired sweeps will not be done automatically; you will have to "Recalculate" this data (covered later).  But once you have checked the right boxes in the listbox, subsequent sweeps will be analyzed and (optionally) the results plotted in the Analysis Window.  Try this out by attaching a model cell or some other load to your amplifier headstage, and then press the "Start" button in the Selector Window.  At an interval determined by the "ISI" control in the Selector Window, you should see the Analysis Window populate with colored data points corresponding to analyzed data on the just acquired sweeps.  If the Analysis Method is "Baseline", which it will be if you are just starting out with a new user, these data points will correspond to the baseline value of each acquired sweep on the active channels.  Notice that they are plotted against a Time axis, although there is (at least) one point for every sweep.  So if you press "Stop" in the Selector Window, wait a while, and start again, the next points may appear somewhat to the right of the earlier points.  In order to see your data, you may need to change the axis limits of the Time axis, or alternatively press Ctrl-A to autoscale.  

(5.3) The data values that appear in the Analysis Window will probably be/seem meaningless if you have not specified a range for analysis in the Sweeps Window.  Such a range might correspond to, for example, the peak of an EPSC.  To do this, select one of the analysis methods currently in the analysis window to make it "active".  To do this, simply click on the axis label for that method.  When the axis becomes bold, you have successfully made that method active.  Active simply means that any changes you make to the settings in the Sweeps Window or the Analysis Window will apply to that method, while the settings for other methods will remain unchanged.  

(5.4) Once an analysis method is active, find the cursors (circle=A, square=B) in the Sweeps Window and move them to an appropriate location.  What location is appropriate will depend on the analysis method you have selected as active.  For example, for the "Peak" analysis method, you should place the cursors to the left and right of a peak in your acquired sweep (or where you expect a peak to appear).  This ensures that the region between the cursors will be used to find a peak whose amplitude can then be plotted in the Analysis Window.  It should be noted that many analysis methods will give the same result no matter where the cursors are placed.  For example, the "Input Resistance" method calculates its results based upon the location of the test pulse, not the cursor locations.  The cursor locations are distinct for every analysis method.    Thus, if you set the cursor locations with one analysis method selected, and then set the cursor locations with another analysis method selected, you can switch back and forth between the two analysis methods (click back and forth on their corresponding axis labels), and you will see that the cursor locations switch back and forth between two sets of positions.  

(5.5) Some analysis method will require a baseline value to be calculated as well.  For example, in the "Peak" analysis method, the baseline is what is subtracted from the peak extremum to calculate the peak amplitude.  There are two options to set the location used to calculate a baseline.  One is to simply let it be computed automatically.  This will result in a short baseline region prior to the first stimulus pulse being used.  To do this automatic baseline selection, check the "Auto" box next to the "Set Baseline" button in the Sweeps Window.  To set the baseline region manually, move the cursors around a region that you would like to use as a baseline, and click the "Set Baseline" button.  Be aware that the last location of the cursors is the location used for the main analysis function of the method itself, so after clicking "Set Baseline" you will want to move the cursors back to the location of the, for example, peak you are trying to measure.  

(5.6) If you do this correctly, the values that will begin appearing the analysis window with each sweep should be the correct values.  There are several modifications you can make to get different kinds of results for each analysis method.  First, for some analysis methods, there will be two checkboxes available in the right-hand side of the analysis window.  These checkboxes allow you to select either or both of two different kind of analysis for each analysis method, called the "main" and "auxiliary" analysis.  For example, for the "Peak" analysis method, the main analysis is the amplitude of the peak between the cursors, and the auxiliary analysis is the amplitude of the peak at a corresponding location one inter-pulse interval further in time.  This is useful to measure, for example, the response to the first and second pulse of a paired pulse stimulus, while requiring cursors to be placed only around the peak of the response to the first pulse.  To select either or both of the main and auxiliary methods, simply check/uncheck the named checkboxes.  The names of the checkboxes will change depending on which analysis method is selected.  Some analysis methods also have a numeric control which allows an analysis parameter to be set.  For example, for the "PeakWX" analysis method, this is the width around cursor A to be averaged in order to compute an amplitude.  As another example, for the "Minis" analysis method, this is the amplitude threshold for detecting miniature synaptic currents.  Many methods have no parameters to set and thus the numeric control is not visible when one of these methods is selected.  Lastly, some analysis methods depend on whether the user is searching for a minimum or a maximum value.  For example, when searching for the peak of an inward current, one would search for a local minimum.  By contrast, if this is an outward current, one would search for a local maximum.  For analysis methods where the choice of minimum vs maximum is relevant, there is a pull-down menu in the Analysis Window to select between these options.  The pull-down menu allows you to select which channels, if any, should be searched for a minimum.  By default, the rest are searched for a maximum.  

(5.7) All of the above allows you to do analysis online, that is, to collect analyzed values as soon as the sweep is acquired.  However, you can also analyze offline, which can either be before or after the experiment is actually completed.  Analysis of data that has already been collected is called "reanalysis".  To reanalyze a segment of the experiment, place the cursors in the Analysis Window around the region of time that you want to reanalyze.  For example, to reanalyze sweep 14 through sweep 23, place the cursors on sweep 14 and sweep 23.  The numeric controls "A" and "B" in the Analysis Window will tell you where your cursors are.  They will be mirrored by the corresponding controls in the Sweeps Window, to help you choose the appropriate sweeps from that window.  To do the reanalysis, click the "Recalculate" button.  Note that only the analysis from the selected method will be recomputed.  You will need to select the other analysis methods by clicking on their axis labels to reanalyze them.  In order to reanalyze only certain channels, simply hide the channels that you do not want reanalyzed by unchecking their checkboxes in the left-hand side of the Sweeps Window.  This will hide these channels in both the Sweeps and the Analysis Window, and protect their analyzed values from reanalysis.  A common case for reanalysis might be to simply change the location of the cursors in the Sweeps Window, in order to better constrain the calculation of a peak amplitude.  After changing the cursor locations in the Sweeps Window, pressing "Recalculate" in the Analysis Window would reanalyze the sweeps between the cursors in the Analysis Window using the new cursor locations in the Sweeps Window, for the selected analysis method.  

(5.8) There are a number of options to aid you in the visualization of your analysis.  First, there is a "Trend" pull-down menu in the left-hand size of the Analysis Window.  Selecting an option from this menu will add a trend line to the region between the cursors in the Analysis Window.  The options from this menu are "Linear Regression" (a simple regression line), "Decimation", which appends a downsampling of the analyzed data, and "Loess" (a smooth curve through the data).  The "Normalize" button normalizes the data between the cursors to have a mean value of 1.  This enables an easy comparison of data outside the cursors to that within the cursors, for example to assess a fractional/percentage change in the amplitude of a value across regions of time.  The "Normalize" button does not actually change the analyzed values, but simply rescales the plot to make it appear as if they have a mean of 1.  Lastly, the "Scale" button scales the axis of the selected analysis method so that its minimum and maximum value of the axis are equal to the minimum and maximum value of the data between the cursors.  This makes it easy to see the full range of the data and nothing more. 

(6,7,8,...) Description of each analysis method, dedicated Mini PSC analysis, Trace averaging, and more. 

(9) The Code

(9.1) Updating the code.  When updates are made to the software by the developers, you may want to download these updates to use new features or fix bugs.  This is done by:  
-- Quitting Igor
-- Opening the My Documents/Igor Pro User Files/User Procedures folder and right-clicking the Recording Artist (or recording-artist) folder
-- Selecting TortoiseHg / Synchronize from the context menu.  
-- Clicking the â€œpullâ€ icon (second from left in Fig. 9.1).  This will download the updates.  
-- Close that window and Update from the same right-click context menu that had Synchronize.  This applies the updates.   
-- Open Igor again to use the new version of the code.  

Fig. 9.1

The synchronization toolbar in TortoiseHg.  The pull icon is the second from the left.  

(9.2) Navigating the code.  If you want to examine what is happening in the code from the moment the "Start" button is pressed in the Selector window, go to the function WaveSelectorButtons and look for the "Start" case.  You go to any function by either typing its name in the Command Window, right-clicking and selecting "Go To..." or if you know what procedure file it is in (in this case Acquisition Windows), you can go to that procedure file by selecting it from Windows / Procedure Windows, and find the function in the drop-down menu at the bottom that says "Procedures".  

You will reach a seeming dead end in a couple of places:  

One is when you get to functions in the DAQ Interface procedure file.  All of these functions wrap functions in NIDAQmx Wrappers, ITC Wrappers, or LIH Wrappers depending on your devices.  It may not be obvious from the code that this is happening, but you can just find the cognate function in correspodning wrappers procedure file to see what is happening.  

The other is once acquisition has begun, control by my code ends, and the deviceâ€™s XOP takes over.  It fills the waves (sweeps) you see on your screen, and when it is finished it calls a hook function in my code that was set before acquisition began.  In the case of my code that hook function is usually called "CollectSweep" (for the Seal Test it is SealTestCollectSweep), so that is where control by my code begins once the sweep is collected.  

To see what every other button or menu is doing, press Ctrl-T, double-click it in the box that comes up, find the function name listed next to Procedure.  Find that function in its procedure file and you can follow the code from there. 



